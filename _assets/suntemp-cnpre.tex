\documentclass[fontset=fandol,envcountsect]{ctexbeamer}

% --- pandoc ---

\usepackage{subcaption}

$if(highlighting-macros)$
  $highlighting-macros$
$endif$

$tightlist.tex()$
$tables.tex()$
$graphics.tex()$

% --- code font size ---

$if(highlighting-macros)$
\renewenvironment{Shaded} {\begin{snugshade}\scriptsize} {\end{snugshade}}
$endif$

% --- bib ---

% \usepackage[backend=biber,style=ieee]{biblatex}
\usepackage[backend=biber,style=gb7714-2015,autocite=plain]{biblatex}
\addbibresource{$bibliography$}

\makeatletter % force emph things in biblatex to be italic
\renewrobustcmd*{\mkbibemph}{\mkbibitalic}
\protected\long\def\blx@imc@mkbibemph#1{\blx@imc@mkbibitalic{#1}}
\makeatother

% --- numbering ---

\setbeamertemplate{theorems}[numbered]
\setbeamertemplate{caption}[numbered]

% --- thm ---

\makeatletter
\def\cleartheorem#1{%
    \expandafter\let\csname#1\endcsname\relax
    \expandafter\let\csname c@#1\endcsname\relax
}
\makeatother

\cleartheorem{theorem}
\cleartheorem{lemma}
\cleartheorem{corollary}
\cleartheorem{definition}
\cleartheorem{example}
\cleartheorem{solution}

\theoremstyle{theorem}
\newtheorem{theorem}{定理}[section]
\newtheorem{definition}{定义}[section]
\newtheorem{lemma}{引理}[section]
\newtheorem{corollary}{推论}[section]
\newtheorem{proposition}{命题}[section]
\newtheorem{conjecture}{猜想}[section]

\theoremstyle{example}
\newtheorem{example}{例}[section]
\newtheorem{exercise}{习题}[section]

\theoremstyle{remark}
\newtheorem*{myproof}{证明}
\newtheorem*{solution}{解}
\newtheorem*{remark}{评注}

\renewenvironment{proof}{\begin{myproof}}{\qed \end{myproof}}

% \addtobeamertemplate{proof begin}{\setbeamercolor{block title}{bg=black}}{}
\AtBeginEnvironment{proof}{\setbeamercolor{block title}{bg=black}}
\AtBeginEnvironment{solution}{\setbeamercolor{block title}{bg=black}}
\AtBeginEnvironment{remark}{\setbeamercolor{block title}{bg=black}}

% --- styles ---

\usetheme{Madrid}
\usefonttheme[onlymath]{serif}

\setlength{\parindent}{2em}
\addtobeamertemplate{block begin}{}{\setlength\parindent{2em}}
\addtobeamertemplate{block example begin}{}{\setlength\parindent{2em}}
\addtobeamertemplate{alertblock alerted begin}{}{\setlength\parindent{2em}}

\setlength{\parskip}{3pt} % slighty more spacing

\hypersetup{
    colorlinks=true,
    urlcolor=violet,
    linkcolor=, % default color for other links
    citecolor=beamer@blendedblue,
    anchorcolor=,
    filecolor=
}

\newcommand{\myemph}[1]{{\usebeamercolor[fg]{structure} #1}}
\renewcommand{\emph}{\myemph}
\let\textbf\alert

% --- structures ---

\AtBeginSection[]
{
  \begin{frame}{目录}
    \tableofcontents[currentsection]
  \end{frame}
}
\AtBeginSubsection[]
{
  \begin{frame}{目录}
    \tableofcontents[currentsubsection]
  \end{frame}
}

% -----

\title{$title$}
$if(subtitle)$
\subtitle{$subtitle$}
$endif$
\author{$for(author)$$author$$sep$ \and $endfor$}
$if(institute)$
\institute{$for(institute)$$institute$$sep$ \and $endfor$}
$endif$
\date{$date$$if(date-modified)$\thanks{最后更新于 $date-modified$．}$endif$}

\begin{document}

\frame{\titlepage}

\begin{frame}{目录}
  \tableofcontents
\end{frame}

$body$

$if(bibliography)$
\begin{frame}[allowframebreaks]{参考文献}
    \printbibliography[heading=none]
\end{frame}
$endif$

\end{document}